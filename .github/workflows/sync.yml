# Workflow 名称
name: Sync README.md to index.html in docs

# 触发 workflow 的事件
on:
  push:
    branches:
      - main # 请将 'main' 替换为您仓库的默认分支名，例如 master
    paths:
      - README.md # 只在 README.md 文件发生变化时触发

# 定义作业 (jobs)
jobs:
  sync:
    # 在最新的 Ubuntu 环境上运行作业
    runs-on: ubuntu-latest

    # 作业步骤
    steps:
    - name: Checkout 代码
      # 使用 actions/checkout@v4 检出仓库代码
      uses: actions/checkout@v4

    - name: 安装 pandoc
      # 使用 apt-get 在 Ubuntu 环境中安装 pandoc
      run: |
        sudo apt-get update
        sudo apt-get install -y pandoc

    - name: 创建 docs 目录 (如果不存在)
      # 创建 docs 目录，-p 参数确保如果父目录不存在也会一并创建
      run: mkdir -p docs

    - name: 将 README.md 转换为 docs/index.html
      # 使用 pandoc 工具将 Markdown 文件转换为 HTML，并保存到 docs 文件夹
      run: |
        pandoc README.md -s -o docs/index.html

    - name: 自动提交并推送 changes 到 docs/index.html
      # 使用 stefanzweifel/git-auto-commit-action@v5 自动提交生成的 index.html 文件
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        # 提交消息
        commit_message: Sync README.md to docs/index.html
        # 指定要提交的文件，现在是 docs/index.html
        files: docs/index.html
        # 可选：设置提交作者信息
        # commit_user_name: Automated Sync
        # commit_user_email: actions@github.com
